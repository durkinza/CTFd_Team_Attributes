function click_scope(a){return function(e){a.modal()}}function dropdown_scope(a,e,t){return CTFd.fetch("/api/v1/attributes/"+e.id+"/options",{method:"GET",credentials:"same-origin",headers:{Accept:"applications/json","Content-Type":"application/json"}}).then(function(a){return a.json()}).then(function(e){$.each(e.data,function(e,n){a.append($('<option value="'+n.value+'" '+(n.value==t?"selected":"")+">"+n.name+"</option>"))})})}function handle_attr_submit(a){a.submit(function(e){console.log("setting submit function"),e.preventDefault();var t=a.attr("data-attr-id"),n=a.serializeJSON(!0);console.log(n),CTFd.fetch("/api/v1/attributes/"+t+"/"+n.team_id,{method:"POST",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(a){return a.json()}).then(function(e){e.success?window.location=CTFd.config.urlRoot+"/team":(a.find("#results").empty(),Object.keys(e.errors).forEach(function(t,n){a.find("#results").append(CTFd.ui.ezq.ezBadge({type:"error",body:e.errors[t]}));var d=a.find("input[name={0}]".format(t)),i=$(d);i.addClass("input-filled-invalid"),i.removeClass("input-filled-valid")}))})})}$(document).ready(function(){if(/team$/.test(window.location)){var a=CTFd.fetch("/api/v1/attributes",{method:"GET",credentials:"same-origin",headers:{Accept:"applications/json","Content-Type":"application/json"}}).then(function(a){return a.json()}),e=CTFd.fetch("/api/v1/attributes/team/me",{method:"GET",credentials:"same-origin",headers:{Accept:"applications/json","Content-Type":"application/json"}}).then(function(a){return a.json()});$.when(a,e).then(function(a,e){if(a.success&&a.data.length>0){var t=$("<i/>",{class:"btn-fa fas fa-pencil-alt fa-2x px-2","data-toggle":"tooltip","data-placement":"top",title:"Edit Attributes"}),n=$("<a/>",{class:"edit-attr"}).append(t);$(".edit-team").parent().append(n),n.click(function(a){$("#team-attr-modal").modal()});var d=$('main[role="main"]'),i=$("<div/>",{id:"team-attr-modal",class:"modal fade"}),l=$("<div/>",{class:"modal-dialog"}),o=$("<div/>",{class:"modal-content"}),s=$('<div class="modal-header"><h2 class="modal-action text-center w-100">Edit Team Attributes</h2><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),r=$("<div/>",{class:"modal-body clearfix"});i.append(l.append(o.append(s).append(r)));var c=$("<table/>",{class:"table table-striped table-hover"}).append($("<thead><tr><td><b>Attribute</b></td></tr></thead>")),p=$("<tbody/>");r.append(c.append(p)),d.append(i);for(var u=0;a.data.length>u;u++){var m=a.data[u],v=$("<tr class='team-attr' data-attr-id='"+m.id+"'><td><a>"+m.name+"</a></td></tr>");p.append(v);var f=$("<div/>",{id:"team-attr-modal-"+m.id,class:"team-attr-modal modal fade"});v.click(click_scope(f));l=$("<div/>",{class:"modal-dialog"}),o=$("<div/>",{class:"modal-content"}),s=$('<div class="modal-header"><h2 class="modal-action text-center w-100">'+m.name+'</h2><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),r=$("<div/>",{class:"modal-body clearfix"});f.append(l.append(o.append(s).append(r)));var b=$("<form/>",{id:"set-team-attr-form-"+m.id,method:"POST",class:"set-team-attr-form","data-attr-id":m.id});attr_form_group=$("<div/>",{class:"form-group",id:"team-attr-form-group-"+m.id});var h=null!=(h=e.data.find(a=>a.attr_id==m.id))?h.value:m.default,y=m.frozen||!team_captain;switch(console.log(m),m.type){case"Checkbox":var g='<div class="form-check form-check-inline"><input class="form-check-input attr-value" type="checkbox" name="value" id="value-'+m.id+'" '+(y?"disabled ":"")+("false"==h||"0"==h?"":"checked")+'><label class="form-check-label" for="value">'+m.name+"</label>";break;case"Password":g='<label for="value">'+m.name+'</label><input type="password" class="form-control attr-value" name="value" id="value-'+m.id+'" '+(y?"disabled ":"")+' value="'+h+'">';break;case"Select":var _=$("<select "+(y?"disabled":"")+"/>",{class:"form-control attr-value",name:"value",id:"value-"+m.id}),k=$('<label for="value">'+m.name+"</label>");g=$("<div/>").append(k).append(_);dropdown_scope(_,m,h);break;case"Number":g='<label for="value">'+m.name+'</label><input type="number" class="form-control attr-value" name="value" id="value-'+m.id+'" '+(y?"disabled ":"")+' value="'+h+'">';break;case"Text Area":g='<label for="value">'+m.name+'</label><textarea class="form-control attr-value" name="value" id="value-'+m.id+'" '+(y?"disabled ":"")+">"+h+"</textarea>";break;default:g='<label for="value">'+m.name+'</label><input type="text" class="form-control attr-value" name="value" id="value-'+m.id+'" '+(y?"disabled ":"")+' value="'+h+'">'}attr_form_group.append(g),r.append(b.append('<input type="hidden" name="id">').append('<input type="hidden" name="attr_id" value="'+m.id+'">').append('<input type="hidden" name="team_id" value="'+stats_data.id+'">').append(attr_form_group).append('<div id="results"></div><button id="set-team-attribute-'+m.id+'" type="submit" class="btn btn-primary btn-outlined float-right modal-action '+(y?"disabled":"")+'" '+(y?"disabled":"")+">Submit</button>")),handle_attr_submit(b)}}})}});
